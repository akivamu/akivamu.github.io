---
layout: post
title: JavaScript sparse array by example
date: '2017-02-08T11:31:00.000+07:00'
author: Huy Luu
tags:
- JavaScript
modified_time: '2017-02-14T11:32:13.173+07:00'
blogger_id: tag:blogger.com,1999:blog-2409403985918607624.post-7171282983501286511
blogger_orig_url: http://publicloop.blogspot.com/2017/02/javascript-sparse-array-by-example.html
---

<h2>In the end, a JavaScript array is still a object</h2><pre class="prettyprint">var arr = [] // declare new array<br /><br />// Has properties<br />arr.test1 = 111<br />arr['test1'] = 111 // can access by square bracket<br />arr.test1 == arr['test1'] // true<br /><br />arr['test2'] = 111<br />arr.test1 == arr.test2 // true</pre><h2>Only valid natural numeric properties are counted as index</h2>Valid index range: [0,2^32-1)<br />If we use invalid index, then JS treats array as normal object, not array nature.<br /><pre class="prettyprint">arr.length == 0 // true - 'test1' and 'test2' are not numeric, not counted as array elements<br /><br />arr['0'] = 111 // make first element, at index 0<br />arr.length == 1 // true - '0' is number, so now array has 1 element<br /><br />arr['-1'] = 111<br />arr[-1] = 111<br />arr.length == 1 // true - '-1' is number but out of valid range, so not counted as array elements<br />arr['-1'] // will print 111, '-1' is not counted as index, but still a property and can be accessed as normal<br />arr[-1] // will print 111 also<br /><br />arr[4294967296] = 222<br />arr.length == 1 // true - '4294967296' is number but out of valid range, so not counted as array elements<br />arr[4294967296] // will print 222, '4294967296' is not counted as index, but still a property and can be accessed as<br />normal<br /><br />arr.0 = 111 // Syntax error: must use square bracket to access numeric properties</pre><h2>Add element at arbitrary index</h2>Array will expand to fit largest index number<br /><pre class="prettyprint">arr['2'] = 222 // let skip index 1, make element at index 2<br />arr.length == 3 // true - now array has 3 elements<br />arr // will print [111,,222] note that there is a hole in middle</pre> Force change `length` property <pre class="prettyprint"><br />arr.length = 5 // manually increase length from 3 to 5<br />arr // will print [111,,222,,] &nbsp; &nbsp;2 holes are added at the end<br /><br />arr.length = 1 // manually reduce length from 5 to 1<br />arr // will print [111] &nbsp; &nbsp;all elements beyond length are removed</pre><h2>Array with holes is called sparse array</h2><pre class="prettyprint">var sparseArr = []<br />sparseArr[0] = 0<br />sparseArr[3] = 3<br />sparseArr // will print [0,,,3] there are 2 holes in middle<br /><br />var sparseArr = [0,,,3] &nbsp;// another method to create array with holes<br />sparseArr // will print [0,,,3] there are 2 holes in middle<br /><br />// Holes are also counted in array length<br />sparseArr.length // will print 4, included 2 holes</pre><h2>Array without holes is called dense array</h2><pre class="prettyprint">var denseArr = []<br />denseArr[0] = 0<br />denseArr[1] = undefined<br />denseArr[2] = undefined<br />denseArr[3] = 3<br /><br />var denseArr = [0,undefined,undefined,3] &nbsp;// another method to create array without holes</pre><br /><h2>Sparse array vs dense array</h2><pre class="prettyprint">var sparse = [0,,2]<br />var dense = [0,undefined,2]<br /></pre><h3>for var</h3><pre class="prettyprint">for (var i=0; i&lt;sparse.length; i++) console.log(sparse[i]);<br />// both sparse and dense have the same output<br />// 0<br />// undefined<br />// 2<br /></pre><h3>    forEach</h3><pre class="prettyprint">sparse.forEach(function (x) { console.log(x) });<br />// will print<br />// 0<br />// 2<br /><br />dense.forEach(function (x) { console.log(x) });<br />// will print<br />// 0<br />// undefined<br />// 2<br /></pre><h3>    for in</h3><pre class="prettyprint">for (var key in sparse) { console.log(key) }<br />// will print<br />// 0<br />// 2<br /><br />// Now add non-index property<br />sparse['test'] = 'test';<br />for (var key in sparse) { console.log(key) }<br />// will print<br />// 0<br />// 2<br />// test<br /></pre>So avoid use for in to loop over array, because it includes non-index property also  