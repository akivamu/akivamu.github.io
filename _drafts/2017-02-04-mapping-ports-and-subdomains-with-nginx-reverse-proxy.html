---
layout: post
title: Mapping ports and sub-domains with NGINX reverse proxy
date: '2017-02-04T20:43:00.001+07:00'
author: Huy Luu
tags:
- Server
modified_time: '2017-02-04T20:43:27.663+07:00'
blogger_id: tag:blogger.com,1999:blog-2409403985918607624.post-1668120719333130680
blogger_orig_url: http://publicloop.blogspot.com/2017/02/mapping-ports-and-subdomains-with-nginx-reverse-proxy.html
---

This is simple step by step guide to setup a Reverse Proxy using nginx in Linux. Installing step takes Ubuntu for example, but you can go to <a href="http://nginx.org/en/download.html" rel="nofollow" target="_blank">nginx page</a> for other platform install guide. <h2>Intro</h2>For simplicity, let assume our situation like this:<br /><ul><li>We have a domain <b>example.com</b>.</li><li>We have a server, running Ubuntu for example.</li><li>This server running 2 webpages, in separate HTTP ports: <b>1111</b> and <b>2222</b>.</li><li>We want to use root domain <b>example.com</b> to serve webpage in port <b>1111</b>.</li><li>We want to add a blog to sub domain <b>blog.example.com</b>, which serve webpage in port <b>2222</b>.</li></ul>In short, we want to forward visitor like this:<br /><ul><li>example.com &nbsp; &nbsp;-&gt; localhost:1111</li><li>blog.example.com &nbsp; &nbsp; -&gt; localhost:2222</li></ul><h2>Install</h2>Here is install for Ubuntu with apt tool. For other OS, you can go to nginx home page for detail.<br /><pre class="prettyprint">apt install nginx<br /></pre><h2>Declare sites</h2>We declare rules for proxy by create 2 files in <i>/etc/nginx/sites-available/</i><br /><br />For root domain <b>example.com</b>:<br /><pre class="prettyprint">nano&nbsp;/etc/nginx/sites-available/example.com<br /></pre><pre class="prettyprint">server {<br />&nbsp; listen 80;<br />&nbsp; server_name example.com;<br />&nbsp; location /<br />&nbsp; &nbsp; proxy_pass http://127.0.0.1:1111;<br />&nbsp; &nbsp; include /etc/nginx/proxy_params;<br />&nbsp; }<br />}<br /></pre><br />For sub domain <b>blog.example.com</b>:<br /><pre class="prettyprint">nano&nbsp;/etc/nginx/sites-available/blog.example.com<br /></pre><pre class="prettyprint">server {<br />&nbsp; listen 80;<br />&nbsp; server_name blog.example.com;<br />&nbsp; location /<br />&nbsp; &nbsp; proxy_pass http://127.0.0.1:2222;<br />&nbsp; &nbsp; include /etc/nginx/proxy_params;<br />&nbsp; }<br />}<br /></pre><h2>Enable sites</h2>Link your sites configuration from folder <i>sites-available</i> to folder <i>sites-enabled</i>:<br /><pre class="prettyprint">ln -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/example.com<br />ln -s /etc/nginx/sites-available/blog.example.com /etc/nginx/sites-enabled/blog.example.com<br /></pre><h2>Restart nginx</h2><pre class="prettyprint">service nginx restart<br /></pre>